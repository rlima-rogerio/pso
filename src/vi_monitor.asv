%% Voltage and Current Sampling and Scaling


%% Voltage Monitor
R3 = 1500;
R4 = 13700;
Vmax = 33.4; % Maximum battery voltage

V_div = R3/(R3 + R4)


Vadc_max = V_div * Vmax

%% Current Monitor
Rshunt = 0.5e-3;
RL = 110e3;
IV_ratio = 1e-3; % 1000 uA/V = 1 mA/V = 0.001 A/V
Vadc_max = 3.3;
Vout_max = V_adc_max;

Is_max = Vout_max / (Rshunt * IV_ratio * RL)

sPri

Vout = Is * Rshunt *(1000) * RL;


Imax = Vadc_max/Rshunt; % Maximum current 6600 A

current_meas_v = 30;
I = current_meas_v/Rshunt;